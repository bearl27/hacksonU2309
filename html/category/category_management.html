<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <title>メニューバーの色変更</title>
    <style>
        /* tag ボタンの親要素のスタイル（画面上部中央に配置） */
        .tag-container {
            text-align: center;
            /* 要素を中央配置 */
            position: fixed;
            /* 固定位置に配置 */
            left: 37%;
            /* 画面中央に配置 */
            transform: translate(-50%, 0);
            /* 中央に配置 */
        }

        /* メニューバーのデフォルトのスタイル */
        #menu-bar {
            background-color: #fff;
            color: #000;
            padding: 10px;
            border: 1px solid rgb(0, 0, 0);
            width: 40%;
            height: 90%;
            margin: 0 auto;
            /* 左右のマージンを自動で調整して中央に配置 */
            justify-content: center;
            /* 垂直方向中央配置 */
            align-items: center;
            /* 水平方向中央配置 */

            position: fixed;
            /* 固定位置に配置 */
            top: 493px;
            /* 画面中央に配置 */
            left: 50%;
            /* 画面中央に配置 */
            transform: translate(-50%, -50%);
            /* 中央に配置 */
        }

        /* ボタンのスタイル */
        button {
            padding: 10px 20px;
            color: #fff;
            cursor: pointer;
        }

        .tag {
            left: 100%;
            /* ボタンを水平方向中央配置 */
        }

        .color-button {
            margin-top: 10px;
            /* ボタンの上に10pxの上部マージンを設定 */
            margin-bottom: 10px;
            /* ボタンの下に10pxの下部マージンを設定 */
            margin-right: 10px;
            /* ボタン間の水平間隔を設定 */
        }

        #a {
            background-color: rgba(255, 0, 0, 0.598);
            border: 1px solid rgb(183, 0, 0);
        }

        #b {
            background-color: #00000052;
            border: 1px solid #333;
        }

        #c {
            background-color: rgba(0, 176, 0, 0.601);
            border: 1px solid rgb(0, 66, 0);
        }

        #add-tag-button {
            background-color: #333;
            border: 1px solid rgb(0, 0, 0);
        }


        #red-button {
            background-color: rgba(255, 0, 0, 0.598);
            border: 1px solid rgb(183, 0, 0);
        }

        #black-button {
            background-color: #00000052;
            border: 1px solid #333;
        }

        #green-button {
            background-color: rgba(0, 176, 0, 0.601);
            border: 1px solid rgb(0, 66, 0);
        }

        #blue-button {
            background-color: rgba(0, 0, 255, 0.6);
            border: 1px solid rgb(0, 0, 183);
        }

        #purple-button {
            background-color: rgba(128, 0, 128, 0.6);
            border: 1px solid rgb(73, 0, 73);
        }

        #orange-button {
            background-color: rgba(255, 165, 0, 0.6);
            border: 1px solid rgb(183, 101, 0);
        }

        #pink-button {
            background-color: rgba(255, 105, 180, 0.6);
            border: 1px solid rgb(183, 55, 110);
        }

        #cyan-button {
            background-color: rgba(0, 255, 255, 0.6);
            border: 1px solid rgb(0, 183, 183);
        }

        #brown-button {
            background-color: rgba(139, 69, 19, 0.6);
            border: 1px solid rgb(101, 45, 10);
        }

        #gray-button {
            background-color: rgba(128, 128, 128, 0.6);
            border: 1px solid rgb(73, 73, 73);
        }

        #lime-button {
            background-color: rgba(0, 255, 0, 0.6);
            border: 1px solid rgb(0, 183, 0);
        }

        #violet-button {
            background-color: rgba(238, 130, 238, 0.6);
            border: 1px solid rgb(183, 66, 183);
        }

        #indigo-button {
            background-color: rgba(75, 0, 130, 0.6);
            border: 1px solid rgb(45, 0, 73);
        }

        .tag {
            background-color: rgba(255, 0, 0, 0.598);
            border: 1px solid rgb(183, 0, 0);
        }

        #tag-form {
            display: none;
        }

        .title-form{
            background-color: #dcdcdc;
            border: 1px solid #808080;
            font-size: 100%;
        }
    </style>
</head>

<body>
    <div class="tag-container">
        <span class="tags">
            <button id="a" class="tag">買い物</button>
            <button id="b" class="tag">勉強</button>
            <button id="c" class="tag">筋トレ</button>
        </span>
        <!-- 新しいタグを追加するボタン -->
        <button id="add-tag-button">+</button>
    </div>

    <!-- 新しいタグを追加するフォーム -->
    <form id="tag-form">
        <label for="tag-id">新しいタグのID:</label>
        <input type="text" id="tag-id" name="tag-id" required>
        <label for="tag-color">新しいタグの色:</label>
        <input type="color" id="tag-color" name="tag-color" required>
        <button type="submit">タグを追加</button>
    </form>

    <div id="menu-container">
        <nav id="menu-bar">
            <!-- メニューコンテンツ -->
            <h2>カラーを選んで</h2>
            <button id="red-button" class="color-button">&nbsp&nbsp&nbsp&nbsp</button>
            <button id="black-button" class="color-button">&nbsp&nbsp&nbsp&nbsp</button>
            <button id="green-button" class="color-button">&nbsp&nbsp&nbsp&nbsp</button>
            <button id="blue-button" class="color-button">&nbsp&nbsp&nbsp&nbsp</button>
            <button id="purple-button" class="color-button">&nbsp&nbsp&nbsp&nbsp</button>
            <button id="orange-button" class="color-button">&nbsp&nbsp&nbsp&nbsp</button>
            <button id="pink-button" class="color-button">&nbsp&nbsp&nbsp&nbsp</button>
            <button id="cyan-button" class="color-button">&nbsp&nbsp&nbsp&nbsp</button>
            <button id="brown-button" class="color-button">&nbsp&nbsp&nbsp&nbsp</button>
            <button id="lime-button" class="color-button">&nbsp&nbsp&nbsp&nbsp</button>
            <button id="violet-button" class="color-button">&nbsp&nbsp&nbsp&nbsp</button>
            <button id="indigo-button" class="color-button">&nbsp&nbsp&nbsp&nbsp</button>

            <h2>タイトル</h2>
            <form>
                <input type="text" size="55" id="tag-id" name="tag-id" class="title-form" required>
            </form>

        </nav>
    </div>

    <script>
        // クラス名 'tag' を持つボタン要素を取得
        const tagButtons = document.querySelectorAll('.tag');

        // クラス名 'color-button' を持つボタン要素を取得
        const colorButtons = document.querySelectorAll('.color-button');

        let tagID = "a";

        function resetButtons() {
            colorButtons.forEach(function (button) {
                button.textContent = "　　";
            });
        }

        // 'tag' ボタンクリック時の処理
        tagButtons.forEach(function (button) {
            button.addEventListener("click", function () {
                // tagのIDを取得
                tagID = this.id;
                tagButtons.forEach(function (btn) {
                    btn.style.transform = "scale(1)"; // ボタンのサイズを元に戻す
                });

                // クリックされたタグボタンのサイズを変更
                this.style.transform = "scale(1.1)"; // ボタンのサイズを1.2倍に変更
            });
        });

        // 'color-button' ボタンクリック時の処理
        colorButtons.forEach(function (button) {
            button.addEventListener("click", function () {
                // クリックされたボタンの背景色を取得
                const selectedColor = getComputedStyle(this).backgroundColor;

                // 他のタグボタンとの比較
                let colorConflict = false;
                tagButtons.forEach(function (tagButton) {
                    if (tagButton.id !== this.id) {
                        const tagColor = getComputedStyle(tagButton).backgroundColor;
                        if (tagColor === selectedColor) {
                            colorConflict = true;
                            return;
                        }
                    }
                });

                // 警告文を表示
                if (colorConflict) {
                    alert("同じ色は選べません。");
                    return; // 選択をキャンセル
                }

                const color = getComputedStyle(button).backgroundColor; // ボタンの背景色を取得
                resetButtons();
                button.textContent = "✔︎"; // クリックされたボタンにチェックマークを表示
                if (tagID) {
                    document.getElementById(tagID).style.backgroundColor = color; // タグの背景色を設定
                }
            });
        });

        //newTag form
        const tagForm = document.getElementById('tag-form');

        tagForm.addEventListener('submit', function (event) {
            event.preventDefault();

            const tagIDInput = document.getElementById('tag-id');
            const tagColorInput = document.getElementById('tag-color');

            const tagID = tagIDInput.value;
            const tagColor = tagColorInput.value;

            if (!tagID || !tagColor) {
                alert('IDとカラーを入力してください。');
                return;
            }

            // 新しいタグボタンを作成
            const newTagButton = document.createElement('button');
            newTagButton.id = tagID;
            newTagButton.className = 'tag';
            newTagButton.textContent = tagID;
            newTagButton.style.backgroundColor = tagColor;

            // 新しいタグボタンを追加
            document.querySelector('.tags').appendChild(newTagButton);
            // 入力フォームをクリア
            tagIDInput.value = '';
            tagColorInput.value = '';

            // メニューバーを非表示に
            tagForm.style.display = 'none';
            addTagButton.textContent = '+';
        });

        const add = document.getElementById('add-tag-button');
        add.addEventListener('click', () => {
            // メニューバーの表示状態を切り替える
            if (tagForm.style.display === 'none' || tagForm.style.display === '') {
                tagForm.style.display = 'block'; // メニューバーを表示
                add.textContent = '|'; // ボタンのテキストを変更
            } else {
                tagForm.style.display = 'none'; // メニューバーを非表示
                add.textContent = '+'; // ボタンのテキストを変更
            }
        });

    </script>
    
    
</body>

</html>